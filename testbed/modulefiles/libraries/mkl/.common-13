#%Module1.0

# Software description
module-whatis   "Intel MKL Library"
set software    "mkl"
set description "Intel Math Kernel Library"
set html        "http://www.intel.com/"

# Conflict
conflict        "$software"

# Loads software's environment
prepend-path LD_LIBRARY_PATH "$mklroot/lib/intel64"
prepend-path LIBRARY_PATH "$mklroot/lib/intel64"
prepend-path CPATH          "$mklroot/include"
prepend-path INCLUDE          "$mklroot/include"

setenv MKLROOT         "$mklroot"
setenv MKL_LIBS        "-L$mklroot/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lm"
setenv MKL_LIBS_MT        "-L$mklroot/lib/intel64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lm"
if { [ is-loaded "bullxmpi" ] } {
    setenv MKL_SCA_LIBS    "-L$mklroot/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_scalapack_lp64 -lmkl_core -lmkl_blacs_openmpi_lp64 -lm"
    setenv MKL_SCA_LIBS_MT    "-L$mklroot/lib/intel64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_scalapack_lp64 -lmkl_core -lmkl_blacs_openmpi_lp64 -lm"
}
if { [ is-loaded "impi" ] } {
    setenv MKL_SCA_LIBS    "-L$mklroot/lib/intel64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_scalapack_lp64 -lmkl_core -lmkl_blacs_intelmpi_lp64 -lm"
    setenv MKL_SCA_LIBS_MT    "-L$mklroot/lib/intel64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_scalapack_lp64 -lmkl_core -lmkl_blacs_intelmpi_lp64 -lm"
}


# load common functions and behavior
source $env(MODULEPATH)/.common

